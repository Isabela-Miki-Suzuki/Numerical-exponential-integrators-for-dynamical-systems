#!/usr/bin/env python
# coding: utf-8

# # Swing spring application

# Finally, an application is done for the swing spring problem.

# In[1]:


from basecode import *


# ![spring.png](data:image/png;base64,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)

# Image taken from [8].

# From [9], the model is, given $m, k, l$ and $g$,
# 
# \begin{cases}
#   \dot{\theta} = \frac{\rho_\theta}{mr^2}\\
#   \dot{\rho_\theta} = -mgr \sin{\theta}\\
#   \dot{r} = \frac{\rho_r}{m} \\
#   \dot{\rho_r} = \frac{\rho^2_\theta}{mr^3} - k(r - l) + mg \cos{\theta}.
# \end{cases}
# 
# In matrix form,
# 
# $$
#   \frac{d}{dt}\begin{bmatrix}
#               \theta\\
#               \rho_\theta\\
#               r\\
#               \rho_r
#               \end{bmatrix}
#   =
#   \begin{bmatrix}
#   0 & \frac{1}{ml^2} & 0 & 0\\
#   -mgl & 0 & 0 & 0\\
#   0 & 0 & 0 & \frac{1}{m}\\
#   0 & 0 & -k & 0
#   \end{bmatrix}
#   \begin{bmatrix}
#   \theta\\
#   \rho_\theta\\
#   r\\
#   \rho_r
#   \end{bmatrix}
#   +
#   \begin{bmatrix}
#   \frac{\rho_\theta}{m} \left(\frac{1}{r^2}-\frac{1}{l^2}\right)\\
#   -mg(r\sin{\theta}-l\theta)\\
#   0\\
#   \frac{\rho^2_\theta}{mr^3} + kl + mg \cos{\theta}
#   \end{bmatrix}.
# $$

# For $m = 1, l = 1, g = \pi^2, k = 100 \pi^2$, using the etd3rk method deduced, the best one tested,

# In[11]:


def g_swing_spring(x, t):
  m = 1
  l = 1
  gr = np.pi**2
  k = 100 * np.pi**2
  vector = np.zeros(x.size)
  theta = x[0]
  p_theta = x[1]
  r = x[2]
  pr = x[3]
  vector[0] = p_theta/m * (1/r**2 - 1/l**2)
  vector[1] = -m*gr*(r*np.sin(theta)-l*theta)
  vector[3] = p_theta**2/(m*r**3) + k*l + m*gr*np.cos(theta)
  return vector


# In[12]:


m = 1
l = 1
g = np.pi**2
k = 100 * np.pi**2
A = np.matrix([[0,-1/(m*l**2),0,0], [m*g*l,0,0,0], [0,0,0,-1/m], [0,0,k,0]])
n = 10000
t0 = 0.0
tf = 5.0
x0 = np.array([np.pi/2,3,l,1])
domains = 4*[np.arange(t0, tf, (tf-t0)/n)]
x = etd3rk_similar(t0, tf, n, x0, A, g_swing_spring)
names = ['theta','p_theta', 'r', 'pr']
matrix1 = [x[0,:], x[1,:], x[2,:], x[3,:]]

fig1, ax1 = graphic_2D(domains, matrix1, names, 't', ' ', 'swing spring etdrk3 n = '+str(n), False, False)


# In[ ]:




